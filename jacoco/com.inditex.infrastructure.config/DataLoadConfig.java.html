<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="es"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DataLoadConfig.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">test</a> &gt; <a href="index.source.html" class="el_package">com.inditex.infrastructure.config</a> &gt; <span class="el_source">DataLoadConfig.java</span></div><h1>DataLoadConfig.java</h1><pre class="source lang-java linenums">package com.inditex.infrastructure.config;

import com.inditex.domain.model.Price;
import com.inditex.infrastructure.repository.PriceRepository;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Configuration;

import javax.annotation.PostConstruct;
import java.text.ParseException;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;

/**
 * Clase de configuración que carga datos iniciales en la base de datos.
 * Esta clase se ejecuta al inicio de la aplicación para cargar un conjunto de datos de ejemplo relacionados con precios.
 * Utiliza la anotación @PostConstruct para ejecutar el método loadData después de que los beans hayan sido inicializados.
 */
@Configuration
<span class="fc" id="L20">@Slf4j</span>
<span class="fc" id="L21">public class DataLoadConfig {</span>

    @Autowired
    private PriceRepository priceRepository;

    /**
     * Método que se ejecuta después de la construcción del bean y carga datos de ejemplo en la base de datos.
     * Los datos cargados son ejemplos de precios, con diferentes fechas de inicio y finalización.
     *
     * @throws ParseException Si ocurre un error al parsear las fechas de los precios.
     */
    @PostConstruct
    public void loadData() throws ParseException {
        // Formato de fecha para las fechas de inicio y finalización
<span class="fc" id="L35">        DateTimeFormatter formatter = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd-HH.mm.ss&quot;);</span>

<span class="fc" id="L37">        log.info(&quot;Cargando datos iniciales en la base de datos...&quot;);</span>

        // Creación de objetos de precio con datos de ejemplo
<span class="fc" id="L40">        Price price1 = new Price(1L, LocalDateTime.parse(&quot;2020-06-14-00.00.00&quot;, formatter), LocalDateTime.parse(&quot;2020-12-31-23.59.59&quot;, formatter), 1L, 35455L, 0, 35.50, &quot;EUR&quot;);</span>
<span class="fc" id="L41">        Price price2 = new Price(2L, LocalDateTime.parse(&quot;2020-06-14-15.00.00&quot;, formatter), LocalDateTime.parse(&quot;2020-06-14-18.30.00&quot;, formatter), 2L, 35455L, 1, 25.45, &quot;EUR&quot;);</span>
<span class="fc" id="L42">        Price price3 = new Price(3L, LocalDateTime.parse(&quot;2020-06-15-00.00.00&quot;, formatter), LocalDateTime.parse(&quot;2020-06-15-11.00.00&quot;, formatter), 3L, 35455L, 1, 30.50, &quot;EUR&quot;);</span>
<span class="fc" id="L43">        Price price4 = new Price(4L, LocalDateTime.parse(&quot;2020-06-15-16.00.00&quot;, formatter), LocalDateTime.parse(&quot;2020-12-31-23.59.59&quot;, formatter), 4L, 35455L, 1, 38.95, &quot;EUR&quot;);</span>
<span class="fc" id="L44">        Price price5 = new Price(1L, LocalDateTime.parse(&quot;2020-06-14-00.00.00&quot;, formatter), LocalDateTime.parse(&quot;2020-12-31-23.59.59&quot;, formatter), 1L, 35455L, 1, 38.50, &quot;EUR&quot;);</span>

        // Guardado de los precios en la base de datos a través del repositorio
<span class="fc" id="L47">        priceRepository.save(price1);</span>
<span class="fc" id="L48">        log.info(&quot;Precio 1 guardado: {}&quot;, price1);</span>
<span class="fc" id="L49">        priceRepository.save(price2);</span>
<span class="fc" id="L50">        log.info(&quot;Precio 2 guardado: {}&quot;, price2);</span>
<span class="fc" id="L51">        priceRepository.save(price3);</span>
<span class="fc" id="L52">        log.info(&quot;Precio 3 guardado: {}&quot;, price3);</span>
<span class="fc" id="L53">        priceRepository.save(price4);</span>
<span class="fc" id="L54">        log.info(&quot;Precio 4 guardado: {}&quot;, price4);</span>
<span class="fc" id="L55">        priceRepository.save(price5);</span>
<span class="fc" id="L56">        log.info(&quot;Precio 5 guardado: {}&quot;, price5);</span>

<span class="fc" id="L58">        log.info(&quot;Datos iniciales cargados correctamente.&quot;);</span>
<span class="fc" id="L59">    }</span>

    /**
     * Método setter para permitir la inyección de dependencias en pruebas.
     * Este setter se utiliza principalmente para sustituir el repositorio real en un entorno de prueba.
     *
     * @param priceRepository El repositorio de precios que se inyectará en las pruebas.
     */
    public void setPriceRepository(PriceRepository priceRepository) {
<span class="nc" id="L68">        this.priceRepository = priceRepository;</span>
<span class="nc" id="L69">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>